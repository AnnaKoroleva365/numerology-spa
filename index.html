<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Интерактивная Нумерология</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Chosen Palette: "Спокойная Гармония" (Calm Harmony) - (bg-gray-50, white, text-gray-900, accent: bg-indigo-600) -->
    <!-- Application Structure Plan: SPA с навигацией по вкладкам. Структура основана на задачах пользователя, а не на главах отчета. 1. 'Главная': Введение. 2. 'Значения Чисел': Интерактивный справочник по числам (1-9, 11, 22, 33). 3. 'Классические Расчеты': Два калькулятора (Число Жизненного Пути, Расчет по Имени) с визуализацией. 4. 'Матрица Судьбы': Калькулятор 5 основных точек матрицы с визуальным отображением. Эта структура превращает пассивное чтение в активное исследование и расчет. -->
    <!-- Visualization & Content Choices: 1. Значения чисел: Текст отчета -> Цель: Справка/Изучение -> HTML/CSS Grid + JS onClick для отображения информации -> Интерактивный справочник. 2. Число Жизненного Пути: Пример из отчета -> Цель: Расчет -> JS-калькулятор с <input type="date"> -> Автоматизация ручного расчета. 3. Расчет по Имени: Таблица и пример из отчета -> Цель: Расчет/Сравнение -> JS-калькулятор с <input type="text"> -> Автоматизация. 4. График "Состав Имени": Результаты калькулятора (Числа Судьбы, Души, Личности) -> Цель: Визуализация/Сравнение -> Chart.js Doughnut Chart -> Визуализирует "состав" имени пользователя, выполняя требование по Chart.js. 5. Матрица Судьбы: Пример расчета -> Цель: Расчет/Организация -> JS-калькулятор + HTML/Tailwind-диаграмма -> Визуализирует абстрактную структуру матрицы без SVG. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 400px;
            height: auto;
            min-height: 300px;
            max-height: 400px;
            margin-left: auto;
            margin-right: auto;
        }
        .page-section {
            display: none;
        }
        .page-section.active {
            display: block;
        }
        .nav-link {
            transition: all 0.3s ease;
        }
        .nav-link.active {
            border-bottom-color: #4f46e5;
            color: #4f46e5;
            font-weight: 600;
        }
        .matrix-diagram {
            position: relative;
            width: 300px;
            height: 300px;
            margin: 2rem auto;
            transform: rotate(45deg);
        }
        .matrix-point {
            position: absolute;
            width: 70px;
            height: 70px;
            background-color: #e0e7ff;
            border: 2px solid #a5b4fc;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.25rem;
            font-weight: 600;
            color: #3730a3;
            transform: rotate(-45deg);
        }
        #matrix-p1 { top: 0; left: 50%; transform: translate(-50%, -50%) rotate(-45deg); }
        #matrix-p2 { top: 50%; left: 0; transform: translate(-50%, -50%) rotate(-45deg); }
        #matrix-p3 { top: 100%; left: 50%; transform: translate(-50%, -50%) rotate(-45deg); }
        #matrix-p4 { top: 50%; left: 100%; transform: translate(-50%, -50%) rotate(-45deg); }
        #matrix-p5 { top: 50%; left: 50%; transform: translate(-50%, -50%) rotate(-45deg); background-color: #c7d2fe; border-color: #6366f1; }
    </style>
</head>
<body class="bg-gray-50 font-sans text-gray-900 leading-relaxed">

    <header class="bg-white shadow-md">
        <div class="container mx-auto max-w-6xl px-4 py-6">
            <h1 class="text-3xl font-bold text-center text-indigo-800">Интерактивное Пособие по Нумерологии</h1>
            <p class="text-center text-gray-600 mt-1">Исследуйте мир чисел и их влияние на вашу жизнь</p>
        </div>
    </header>

    <nav class="bg-white shadow-sm sticky top-0 z-10">
        <div class="container mx-auto max-w-6xl flex justify-center space-x-4 sm:space-x-8">
            <button class="nav-link py-4 px-2 sm:px-4 text-sm sm:text-base font-medium text-gray-500 hover:text-indigo-600 border-b-2 border-transparent" data-target="home-section">Главная</button>
            <button class="nav-link py-4 px-2 sm:px-4 text-sm sm:text-base font-medium text-gray-500 hover:text-indigo-600 border-b-2 border-transparent" data-target="meanings-section">Значения Чисел</button>
            <button class="nav-link py-4 px-2 sm:px-4 text-sm sm:text-base font-medium text-gray-500 hover:text-indigo-600 border-b-2 border-transparent" data-target="classical-section">Классические Расчеты</button>
            <button class="nav-link py-4 px-2 sm:px-4 text-sm sm:text-base font-medium text-gray-500 hover:text-indigo-600 border-b-2 border-transparent" data-target="matrix-section">Матрица Судьбы</button>
        </div>
    </nav>

    <main class="container mx-auto max-w-6xl p-4 sm:p-8">

        <!-- Секция: Главная -->
        <section id="home-section" class="page-section active">
            <div class="bg-white p-6 sm:p-8 rounded-xl shadow-lg animate-fade-in">
                <h2 class="text-2xl font-semibold text-indigo-700 mb-4">1. Что такое Нумерология?</h2>
                <p class="mb-4 text-gray-700">Нумерология — это древняя эзотерическая система знаний и вера в мистическую связь между числами и жизнью. Основная идея заключается в том, что все во Вселенной вибрирует на определенной частоте, и числа являются ключом к пониманию этих вибраций.</p>
                <p class="mb-2 text-gray-700">С помощью нумерологии можно:</p>
                <ul class="list-disc list-inside space-y-2 text-gray-700">
                    <li>Лучше понять свой характер, сильные и слабые стороны.</li>
                    <li>Определить свои таланты и потенциал.</li>
                    <li>Узнать о своих жизненных задачах и уроках.</li>
                    <li>Проанализировать совместимость с другими людьми.</li>
                </ul>
                <p class="mt-4 text-gray-700">В основе классической нумерологии лежит идея, что все числа можно свести к простым цифрам от 1 до 9, а также к особым "мастер-числам" — 11, 22 (иногда 33).</p>
            </div>
        </section>

        <!-- Секция: Значения Чисел -->
        <section id="meanings-section" class="page-section">
            <div class="bg-white p-6 sm:p-8 rounded-xl shadow-lg">
                <h2 class="text-2xl font-semibold text-indigo-700 mb-4">2. Основные Понятия: Значения Чисел</h2>
                <p class="mb-6 text-gray-700">Каждое число несет свою уникальную энергию. Ниже представлен интерактивный справочник по простым и мастер-числам. Нажмите на любое число, чтобы узнать его подробное значение и символизм.</p>
                
                <h3 class="text-xl font-semibold text-gray-800 mb-3">Простые Числа (1-9)</h3>
                <div class="grid grid-cols-3 sm:grid-cols-5 md:grid-cols-9 gap-3 mb-6">
                    <!-- Числа 1-9 -->
                    <button class="number-card aspect-square bg-indigo-100 text-indigo-800 text-2xl font-bold rounded-lg shadow hover:bg-indigo-200 transition" data-number="1">1</button>
                    <button class="number-card aspect-square bg-indigo-100 text-indigo-800 text-2xl font-bold rounded-lg shadow hover:bg-indigo-200 transition" data-number="2">2</button>
                    <button class="number-card aspect-square bg-indigo-100 text-indigo-800 text-2xl font-bold rounded-lg shadow hover:bg-indigo-200 transition" data-number="3">3</button>
                    <button class="number-card aspect-square bg-indigo-100 text-indigo-800 text-2xl font-bold rounded-lg shadow hover:bg-indigo-200 transition" data-number="4">4</button>
                    <button class="number-card aspect-square bg-indigo-100 text-indigo-800 text-2xl font-bold rounded-lg shadow hover:bg-indigo-200 transition" data-number="5">5</button>
                    <button class="number-card aspect-square bg-indigo-100 text-indigo-800 text-2xl font-bold rounded-lg shadow hover:bg-indigo-200 transition" data-number="6">6</button>
                    <button class="number-card aspect-square bg-indigo-100 text-indigo-800 text-2xl font-bold rounded-lg shadow hover:bg-indigo-200 transition" data-number="7">7</button>
                    <button class="number-card aspect-square bg-indigo-100 text-indigo-800 text-2xl font-bold rounded-lg shadow hover:bg-indigo-200 transition" data-number="8">8</button>
                    <button class="number-card aspect-square bg-indigo-100 text-indigo-800 text-2xl font-bold rounded-lg shadow hover:bg-indigo-200 transition" data-number="9">9</button>
                </div>

                <h3 class="text-xl font-semibold text-gray-800 mb-3">Мастер-Числа</h3>
                <div class="grid grid-cols-3 sm:grid-cols-5 md:grid-cols-9 gap-3">
                    <!-- Числа 11, 22, 33 -->
                    <button class="number-card aspect-square bg-purple-100 text-purple-800 text-2xl font-bold rounded-lg shadow hover:bg-purple-200 transition" data-number="11">11</button>
                    <button class="number-card aspect-square bg-purple-100 text-purple-800 text-2xl font-bold rounded-lg shadow hover:bg-purple-200 transition" data-number="22">22</button>
                    <button class="number-card aspect-square bg-purple-100 text-purple-800 text-2xl font-bold rounded-lg shadow hover:bg-purple-200 transition" data-number="33">33</button>
                </div>
                
                <div id="meaning-display" class="mt-8 p-6 bg-gray-50 rounded-lg min-h-[100px] border border-gray-200">
                    <p class="text-gray-500">Нажмите на число, чтобы увидеть его значение...</p>
                </div>
            </div>
        </section>

        <!-- Секция: Классические Расчеты -->
        <section id="classical-section" class="page-section">
            <div class="bg-white p-6 sm:p-8 rounded-xl shadow-lg">
                <h2 class="text-2xl font-semibold text-indigo-700 mb-4">3. Базовые Расчеты: Классическая Нумерология</h2>
                <p class="mb-6 text-gray-700">В этом разделе вы можете не только узнать о методах расчета, но и сразу рассчитать свои ключевые числа. Мы используем принцип нумерологической редукции (сложения), при котором числа 11 и 22 не сводятся, так как являются мастер-числами.</p>

                <!-- Калькулятор ЧЖП -->
                <div class="border border-gray-200 rounded-lg p-6 mb-6">
                    <h3 class="text-xl font-semibold text-gray-800 mb-3">Калькулятор Числа Жизненного Пути (ЧЖП)</h3>
                    <p class="mb-4 text-gray-600">Это самое важное число в вашей карте. Оно описывает вашу основную жизненную миссию и таланты. Введите вашу полную дату рождения, чтобы рассчитать его.</p>
                    <div class="flex flex-col sm:flex-row sm:items-center gap-4">
                        <input type="date" id="lpn-input" class="form-input px-4 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent">
                        <button id="lpn-button" class="px-6 py-2 bg-indigo-600 text-white font-semibold rounded-lg shadow-md hover:bg-indigo-700 transition duration-300">Рассчитать ЧЖП</button>
                    </div>
                    <div id="lpn-result" class="mt-4 p-4 bg-indigo-50 rounded-lg min-h-[50px] border border-indigo-100">
                        <p class="text-gray-500">Здесь появится ваш результат...</p>
                    </div>
                </div>

                <!-- Калькулятор по Имени -->
                <div class="border border-gray-200 rounded-lg p-6">
                    <h3 class="text-xl font-semibold text-gray-800 mb-3">Калькулятор по Имени (ФИО)</h3>
                    <p class="mb-4 text-gray-600">Ваше полное имя, данное при рождении, содержит код ваших талантов, желаний и того, как вас видят другие. Введите ваше полное ФИО (как в свидетельстве о рождении), используя кириллицу.</p>
                    <div class="flex flex-col sm:flex-row sm:items-center gap-4 mb-6">
                        <input type="text" id="name-input" placeholder="Например: Иванов Пётр Сергеевич" class="w-full sm:w-80 form-input px-4 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent">
                        <button id="name-button" class="px-6 py-2 bg-indigo-600 text-white font-semibold rounded-lg shadow-md hover:bg-indigo-700 transition duration-300">Рассчитать по Имени</button>
                    </div>

                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <div>
                            <div id="name-result" class="p-4 bg-indigo-50 rounded-lg min-h-[150px] border border-indigo-100 mb-6">
                                <p class="text-gray-500">Здесь появятся ваши Числа Судьбы, Души и Личности...</p>
                            </div>
                            <div class="chart-container">
                                <canvas id="nameChart"></canvas>
                            </div>
                        </div>
                        <div>
                            <h4 class="font-semibold text-gray-700 mb-2">Таблица соответствия букв (Кириллица):</h4>
                            <div class="overflow-x-auto">
                                <table class="min-w-full text-sm text-left text-gray-600 border border-collapse border-gray-300">
                                    <thead class="bg-gray-100">
                                        <tr>
                                            <th class="p-2 border border-gray-300">1</th>
                                            <th class="p-2 border border-gray-300">2</th>
                                            <th class="p-2 border border-gray-300">3</th>
                                            <th class="p-2 border border-gray-300">4</th>
                                            <th class="p-2 border border-gray-300">5</th>
                                            <th class="p-2 border border-gray-300">6</th>
                                            <th class="p-2 border border-gray-300">7</th>
                                            <th class="p-2 border border-gray-300">8</th>
                                            <th class="p-2 border border-gray-300">9</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr class="bg-white">
                                            <td class="p-2 border border-gray-300">А, И, С, Ъ</td>
                                            <td class="p-2 border border-gray-300">Б, Й, Т, Ы</td>
                                            <td class="p-2 border border-gray-300">В, К, У, Ь</td>
                                            <td class="p-2 border border-gray-300">Г, Л, Ф, Э</td>
                                            <td class="p-2 border border-gray-300">Д, М, Х, Ю</td>
                                            <td class="p-2 border border-gray-300">Е, Н, Ц, Я</td>
                                            <td class="p-2 border border-gray-300">Ё, О, Ч</td>
                                            <td class="p-2 border border-gray-300">Ж, П, Ш</td>
                                            <td class="p-2 border border-gray-300">З, Р, Щ</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Секция: Матрица Судьбы -->
        <section id="matrix-section" class="page-section">
            <div class="bg-white p-6 sm:p-8 rounded-xl shadow-lg">
                <h2 class="text-2xl font-semibold text-indigo-700 mb-4">4. Введение в "Матрицу Судьбы" (Метод 22 Арканов)</h2>
                <p class="mb-4 text-gray-700">Это отдельный, более современный метод нумерологии, основанный на 22 Старших Арканах Таро. Здесь числа называются "энергиями". Расчет ведется только по дате рождения. Если при сложении получается число **больше 22**, цифры складываются (например, 25 = 2+5 = 7).</p>
                <p class="mb-6 text-gray-700">Введите вашу дату рождения, чтобы рассчитать 5 основных точек вашей "Матрицы Судьбы" — это "верхушка айсберга" данного метода.</p>
                
                <div class="border border-gray-200 rounded-lg p-6">
                    <h3 class="text-xl font-semibold text-gray-800 mb-3">Базовый Расчет "Матрицы"</h3>
                    <div class="flex flex-col sm:flex-row sm:items-center gap-4 mb-6">
                        <input type="date" id="matrix-input" class="form-input px-4 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent">
                        <button id="matrix-button" class="px-6 py-2 bg-indigo-600 text-white font-semibold rounded-lg shadow-md hover:bg-indigo-700 transition duration-300">Рассчитать Матрицу</button>
                    </div>

                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 items-center">
                        <div class="text-gray-700 space-y-3">
                            <p><strong>Точка 1 (Верхний угол):</strong> Ваша "визитная карточка" (День Рождения). <span id="matrix-res-1" class="font-bold text-indigo-700">...</span></p>
                            <p><strong>Точка 2 (Левый угол):</strong> Таланты из прошлых жизней (Месяц Рождения). <span id="matrix-res-2" class="font-bold text-indigo-700">...</span></p>
                            <p><strong>Точка 3 (Нижний угол):</strong> "Кармический хвост", уроки (Год Рождения). <span id="matrix-res-3" class="font-bold text-indigo-700">...</span></p>
                            <p><strong>Точка 4 (Правый угол):</strong> Таланты, которые нужно развить. <span id="matrix-res-4" class="font-bold text-indigo-700">...</span></p>
                            <p class="text-lg"><strong>Точка 5 (Центр):</strong> Ваша суть, "зона комфорта". <span id="matrix-res-5" class="font-bold text-indigo-700 text-xl">...</span></p>
                            
                            <p class="mt-4 pt-4 border-t border-gray-200 text-sm"><strong>Интерпретация:</strong> Каждая из 22 энергий (чисел) в каждой позиции имеет свое значение. Например, 10-я энергия — это "Колесо Фортуны". В "плюсе" — удача и легкий поток, в "минусе" — пассивность и лень. Полный анализ требует глубокого изучения.</p>
                        </div>
                        
                        <div class="matrix-diagram">
                            <div id="matrix-p1" class="matrix-point">?</div>
                            <div id="matrix-p2" class="matrix-point">?</div>
                            <div id="matrix-p3" class="matrix-point">?</div>
                            <div id="matrix-p4" class="matrix-point">?</div>
                            <div id="matrix-p5" class="matrix-point">?</div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

    </main>

    <footer class="text-center py-8 mt-8 border-t border-gray-200">
        <p class="text-gray-500">Нумерология — это мощный инструмент для самопознания. Это не жесткий приговор, а карта, которая показывает ваш потенциал и возможные маршруты.</p>
        <p class="text-gray-400 text-sm mt-1">Интерактивное приложение создано на основе "Основ Нумерологии".</T>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            
            const numberMeanings = {
                1: "<strong>1: Лидерство</strong><br>Независимость, амбиции, начало, 'Я', воля, индивидуальность.",
                2: "<strong>2: Партнерство</strong><br>Дипломатия, чувствительность, гармония, двойственность, сотрудничество.",
                3: "<strong>3: Творчество</strong><br>Общение, оптимизм, самовыражение, артистизм, жизнерадостность.",
                4: "<strong>4: Стабильность</strong><br>Труд, порядок, структура, надежность, практичность, дисциплина.",
                5: "<strong>5: Свобода</strong><br>Перемены, приключения, любопытство, многозадачность, адаптивность.",
                6: "<strong>6: Гармония</strong><br>Семья, ответственность, забота, любовь, служение, домашний уют.",
                7: "<strong>7: Анализ</strong><br>Мудрость, духовность, уединение, интуиция, поиск истины, перфекционизм.",
                8: "<strong>8: Власть</strong><br>Материальный успех, карма, амбиции, сила, бизнес, справедливость.",
                9: "<strong>9: Завершение</strong><br>Гуманизм, мудрость, прощение, сострадание, служение человечеству.",
                11: "<strong>11: Мастер-Число 'Духовный Посланник'</strong><br>Высочайшая интуиция, идеализм, вдохновение. Это усиленная '2'.",
                22: "<strong>22: Мастер-Число 'Мастер-Строитель'</strong><br>Способность воплощать великие идеи в материальную форму. Практичность и мощь. Это усиленная '4'.",
                33: "<strong>33: Мастер-Число 'Мастер-Учитель'</strong><br>Служение, сострадание, исцеление, ответственность за других. Это усиленная '6'."
            };

            const letterMap = {
                'А': 1, 'И': 1, 'С': 1, 'Ъ': 1,
                'Б': 2, 'Й': 2, 'Т': 2, 'Ы': 2,
                'В': 3, 'К': 3, 'У': 3, 'Ь': 3,
                'Г': 4, 'Л': 4, 'Ф': 4, 'Э': 4,
                'Д': 5, 'М': 5, 'Х': 5, 'Ю': 5,
                'Е': 6, 'Н': 6, 'Ц': 6, 'Я': 6,
                'Ё': 7, 'О': 7, 'Ч': 7,
                'Ж': 8, 'П': 8, 'Ш': 8,
                'З': 9, 'Р': 9, 'Щ': 9
            };
            const vowels = ['А', 'И', 'У', 'Э', 'Ы', 'О', 'Ю', 'Я', 'Е', 'Ё'];

            let nameChartInstance = null;

            const navLinks = document.querySelectorAll('.nav-link');
            const pageSections = document.querySelectorAll('.page-section');

            function showSection(targetId) {
                pageSections.forEach(section => {
                    section.classList.remove('active');
                });
                const targetSection = document.getElementById(targetId);
                if (targetSection) {
                    targetSection.classList.add('active');
                }
                navLinks.forEach(link => {
                    link.classList.toggle('active', link.dataset.target === targetId);
                });
            }

            navLinks.forEach(link => {
                link.addEventListener('click', (e) => {
                    showSection(e.target.dataset.target);
                });
            });

            showSection('home-section');
            if (navLinks.length > 0) {
                navLinks[0].classList.add('active');
            }

            const numberCards = document.querySelectorAll('.number-card');
            const meaningDisplay = document.getElementById('meaning-display');
            numberCards.forEach(card => {
                card.addEventListener('click', () => {
                    const number = card.dataset.number;
                    meaningDisplay.innerHTML = numberMeanings[number] || '<p class="text-gray-500">Значение не найдено.</p>';
                });
            });

            function reduceNumber(num) {
                if (num === 11 || num === 22 || num === 33) {
                    return num;
                }
                let strNum = String(num);
                let sum = 0;
                for (let digit of strNum) {
                    sum += parseInt(digit, 10);
                }
                if (sum > 9 && sum !== 11 && sum !== 22 && sum !== 33) {
                    return reduceNumber(sum);
                }
                return sum;
            }

            function reduceForMatrix(num) {
                if (num <= 22) {
                    return num;
                }
                let strNum = String(num);
                let sum = 0;
                for (let digit of strNum) {
                    sum += parseInt(digit, 10);
                }
                return reduceForMatrix(sum);
            }

            const lpnButton = document.getElementById('lpn-button');
            const lpnInput = document.getElementById('lpn-input');
            const lpnResult = document.getElementById('lpn-result');

            lpnButton.addEventListener('click', () => {
                const dateVal = lpnInput.value;
                if (!dateVal) {
                    lpnResult.innerHTML = '<p class="text-red-600">Пожалуйста, выберите дату.</p>';
                    return;
                }
                const [year, month, day] = dateVal.split('-');
                const fullSum = (day + month + year).split('').reduce((acc, digit) => acc + parseInt(digit, 10), 0);
                const lpn = reduceNumber(fullSum);
                
                lpnResult.innerHTML = `
                    <p class="text-gray-700"><strong>Ваше Число Жизненного Пути: <span class="text-2xl text-indigo-700 font-bold">${lpn}</span></strong></p>
                    <div class="mt-2 text-sm">${numberMeanings[lpn] || ''}</div>
                `;
            });

            const nameButton = document.getElementById('name-button');
            const nameInput = document.getElementById('name-input');
            const nameResult = document.getElementById('name-result');

            nameButton.addEventListener('click', () => {
                const name = nameInput.value.toUpperCase();
                if (!name) {
                    nameResult.innerHTML = '<p class="text-red-600">Пожалуйста, введите ваше ФИО.</p>';
                    return;
                }

                let destinySum = 0;
                let soulSum = 0;
                let personalitySum = 0;

                for (let char of name) {
                    if (letterMap[char]) {
                        const val = letterMap[char];
                        destinySum += val;
                        if (vowels.includes(char)) {
                            soulSum += val;
                        } else {
                            personalitySum += val;
                        }
                    }
                }

                const destinyNum = reduceNumber(destinySum);
                const soulNum = reduceNumber(soulSum);
                const personalityNum = reduceNumber(personalitySum);

                nameResult.innerHTML = `
                    <p class="text-gray-700 mb-2"><strong>Число Судьбы (Выражения): <span class="text-xl text-indigo-700 font-bold">${destinyNum}</span></strong><br><span class="text-sm">Ваши таланты и потенциал.</span></p>
                    <p class="text-gray-700 mb-2"><strong>Число Души (Желания Сердца): <span class="text-xl text-indigo-700 font-bold">${soulNum}</span></strong><br><span class="text-sm">Ваши истинные желания и мотивация.</span></p>
                    <p class="text-gray-700"><strong>Число Личности (Внешний Облик): <span class="text-xl text-indigo-700 font-bold">${personalityNum}</span></strong><br><span class="text-sm">Как вас воспринимают другие.</span></p>
                `;

                updateNameChart(destinyNum, soulNum, personalityNum);
            });

            function updateNameChart(d, s, p) {
                const ctx = document.getElementById('nameChart').getContext('2d');
                if (nameChartInstance) {
                    nameChartInstance.destroy();
                }
                nameChartInstance = new Chart(ctx, {
                    type: 'doughnut',
                    data: {
                        labels: [
                            `Число Судьбы (${d})`, 
                            `Число Души (${s})`, 
                            `Число Личности (${p})`
                        ],
                        datasets: [{
                            label: 'Энергии Имени',
                            data: [d, s, p],
                            backgroundColor: [
                                'rgba(79, 70, 229, 0.7)',
                                'rgba(129, 140, 248, 0.7)',
                                'rgba(165, 180, 252, 0.7)'
                            ],
                            borderColor: [
                                'rgba(79, 70, 229, 1)',
                                'rgba(129, 140, 248, 1)',
                                'rgba(165, 180, 252, 1)'
                            ],
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'top',
                            },
                            title: {
                                display: true,
                                text: 'Визуализация Энергий Вашего Имени'
                            }
                        }
                    }
                });
            }

            const matrixButton = document.getElementById('matrix-button');
            const matrixInput = document.getElementById('matrix-input');

            matrixButton.addEventListener('click', () => {
                const dateVal = matrixInput.value;
                if (!dateVal) {
                    alert('Пожалуйста, выберите дату.');
                    return;
                }
                const [year, month, day] = dateVal.split('-');

                const p1 = reduceForMatrix(parseInt(day, 10));
                const p2 = reduceForMatrix(parseInt(month, 10));
                
                const yearSum = year.split('').reduce((acc, digit) => acc + parseInt(digit, 10), 0);
                const p3 = reduceForMatrix(yearSum);
                
                const p4 = reduceForMatrix(p1 + p2 + p3);
                const p5 = reduceForMatrix(p1 + p2 + p3 + p4);

                document.getElementById('matrix-p1').innerText = p1;
                document.getElementById('matrix-p2').innerText = p2;
                document.getElementById('matrix-p3').innerText = p3;
                document.getElementById('matrix-p4').innerText = p4;
                document.getElementById('matrix-p5').innerText = p5;
                
                document.getElementById('matrix-res-1').innerText = p1;
                document.getElementById('matrix-res-2').innerText = p2;
                document.getElementById('matrix-res-3').innerText = p3;
                document.getElementById('matrix-res-4').innerText = p4;
                document.getElementById('matrix-res-5').innerText = p5;
            });

        });
    </script>
</body>
</html>
